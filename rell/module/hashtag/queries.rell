query getThreadsByTagPriorToTimestamp(tag: text, timestamp) {
    return threadTag@*{ 
        .name == tag,
        .thread.timestamp < timestamp
    } (
        id=.thread.id,
        author=.thread.author.name,
        rootThreadId=.thread.rootThreadId,
        message=.thread.message,
        -sort timestamp=.thread.timestamp
    );
}

query getAllTags() {
    return threadTag@*{} ( .name );
}

query getTagsSince(timestamp) {
    return threadTag@*{ .timestamp > timestamp }( .name );
}
